# Implementation Progress

This file tracks the completion status of all implementation tasks for the Car Maintenance Tracker project.

## Purpose

Use this file to:
- Track which tasks have been completed
- Maintain a clear record of project progress
- Add completion dates and any important notes about implementation

## How to Use

When a task is completed:
1. Add the task to the appropriate section below
2. Include the task number, name, and completion date
3. Optionally add notes about any deviations or important implementation details

---

## Completed Tasks

### Infrastructure
- âœ… **01 â€“ Backend, Database & Docker Setup** (Completed: February 18, 2026)
  - **Architecture Refactored (February 18, 2026):** Migrated from entity-specific repository pattern to modern expression-based generic repository pattern
    - Removed virtual methods from Repository<T> base class
    - Updated IRepository<T>.GetAllAsync() to accept optional filter and orderBy expression parameters
    - Deleted entity-specific IMaintenanceTemplateRepository and MaintenanceTemplateRepository classes
    - Updated DI registration to use generic Repository<T> pattern
    - Moved sorting/filtering logic from repository to service layer (proper separation of concerns)
    - Updated all unit tests (32 tests passing - added 1 new filter test)
    - Benefits: More flexible, reusable, follows modern best practices, no need for entity-specific repositories
- âœ… **02 â€“ Frontend & Docker Setup** (Completed: February 18, 2026)

### Backend
- âœ… **01 â€“ GET Maintenance Templates** (Completed: February 18, 2026)
  - Implemented GET /api/setup endpoint to retrieve all maintenance templates
  - Sorting by CreatedAt descending (newest first) implemented using expression pattern in service layer
  - Returns 200 OK with array of MaintenanceTemplateDto (including archived templates)
  - Returns empty array [] with 200 OK when no templates exist
  - Implemented across 3-layer architecture:
    - Repository: Generic Repository<MaintenanceTemplate> with expression parameters for flexible querying
    - Service: GetAllTemplatesAsync() passes orderBy expression to repository and handles DTO mapping
    - Controller: HttpGet endpoint with proper error handling
  - **Unit Tests:** 32 total tests passing (9 Repository + 12 Service + 15 Controller)
    - Repository: Tests for CRUD operations, sorting with orderBy parameter, filtering with filter parameter, empty database
    - Service: Tests for DTO mapping, empty list handling, repository call verification
    - Controller: Tests for 200 OK responses, data return, empty array, error handling, service call verification
    - All tests use xUnit + Moq patterns with Arrange-Act-Assert structure
    - Repository tests use EF Core InMemory provider for complex query verification (Moq for simple CRUD)
  - Docker integration tested successfully - endpoint returns sorted results
- âœ… **02 â€“ POST Create Maintenance Template** (Completed: February 18, 2026)
  - Created MaintenanceTemplate entity with all required properties
  - Implemented 3-layer architecture (Controller â†’ Service â†’ Repository)
  - Added validation for required fields and interval type ("km" or "time")
  - Returns 201 Created with Location header
  - Created and applied EF Core migration
  - Tested successfully in docker-compose environment
  - **Unit Tests:** 21 tests implemented and passing (3 Repository + 8 Service + 10 Controller)
    - Test project: `CarMaintenanceTracker.Api.Tests` using xUnit and Moq
    - All tests follow Arrange-Act-Assert pattern
    - Code coverage report generated
- âœ… **03 â€“ PUT Update Maintenance Template** (Completed: February 18, 2026)
  - Implemented PUT /api/setup/{id} endpoint to update existing maintenance templates
  - All fields can be updated: name, intervalType, intervalValue, archived status
  - CreatedAt field is preserved during updates (not modified)
  - Returns 200 OK with updated MaintenanceTemplateDto on success
  - Returns 404 Not Found when template doesn't exist
  - Returns 400 Bad Request for validation errors (missing required fields, invalid interval type)
  - Implemented across 3-layer architecture:
    - Repository: Uses existing generic Repository<T> methods (GetByIdAsync, UpdateAsync)
    - Service: UpdateTemplateAsync checks existence, validates interval type, updates entity, maps to DTO
    - Controller: HttpPut endpoint with path parameter {id}, ModelState validation, proper error handling
  - Created UpdateMaintenanceTemplateDto with validation attributes
  - Interval type validation enforced ("km" or "time" only)
  - Tested successfully in docker-compose environment:
    - âœ… Successful updates return 200 OK with updated data
    - âœ… Non-existent templates return 404
    - âœ… Invalid interval type returns 400
    - âœ… Missing required fields return 400
    - âœ… Archived status can be toggled via update
    - âœ… CreatedAt timestamp preserved across updates
  - Build succeeds without warnings
- âœ… **06 â€“ GET Cars List** (Completed: February 18, 2026)
  - Implemented GET /api/cars endpoint to retrieve all cars with their maintenance items
  - Returns all cars sorted by CreatedAt descending (newest first)
  - Filters out maintenance items where the associated template is archived
  - Returns 200 OK with array of CarDto (or empty array if no cars exist)
  - Returns 500 Internal Server Error for unexpected errors
  - Implemented across 3-layer architecture:
    - Repository: Uses existing generic Repository<T> with expression-based filtering and ordering
    - Service: GetAllCarsAsync() retrieves cars with maintenance items, loads templates efficiently, filters archived templates, maps to DTOs
    - Controller: HttpGet endpoint with proper error handling and logging
  - Used existing DTOs: CarDto, CarMaintenanceItemDto (created in Task #07)
  - Architecture notes:
    - No entity-specific repository needed - leverages modern generic Repository<T> pattern
    - Service layer loads templates in batch queries to avoid N+1 issues
    - Filtering logic in MapCarToDto method: `.Where(mi => mi.MaintenanceTemplate != null && !mi.MaintenanceTemplate.Archived)`
    - Same filtering applies to both GET /api/cars and GET /api/cars/{id} endpoints
  - Tested successfully in docker-compose environment:
    - âœ… Returns all cars with maintenance items sorted by CreatedAt descending
    - âœ… Empty array returned when no cars exist
    - âœ… Maintenance items with archived templates are filtered out
    - âœ… Maintenance items include all required template details (name, interval type, value)
    - âœ… Next service calculations correct (km and date based)
    - âœ… GET /api/cars/{id} also filters archived templates correctly
    - âœ… No N+1 query issues - templates loaded efficiently in batch
  - All acceptance criteria met:
    - âœ… GET /api/cars returns all cars with maintenance items
    - âœ… Cars sorted newest first
    - âœ… Empty array returned when no data
    - âœ… Maintenance items include template details
    - âœ… Archived template items excluded
    - âœ… Returns 200 OK always
    - âœ… No business logic in controller
    - âœ… Repository pattern respected
  - Build succeeds without warnings
- âœ… **07 â€“ POST Create Car** (Completed: February 18, 2026)
  - Implemented POST /api/cars endpoint to create new cars with associated maintenance items
  - Created Car and CarMaintenanceItem entities with proper relationships
  - Returns 201 Created with Location header pointing to created resource
  - Returns 400 Bad Request for validation errors (missing required fields, negative mileage, invalid templates)
  - Returns 500 Internal Server Error for unexpected errors
  - Implemented across 3-layer architecture:
    - Repository: Created ICarRepository and CarRepository extending generic Repository<T>
      - CreateCarWithMaintenanceItemsAsync handles transactional creation (car + items as atomic operation)
      - GetCarWithMaintenanceItemsAsync loads car with maintenance items and template information
      - GetAllCarsWithMaintenanceItemsAsync returns all cars sorted by CreatedAt descending
    - Service: Created ICarService and CarService with business logic
      - Validates only non-archived templates can be assigned to cars
      - Calculates next service km/date based on interval type:
        - km-based: CalculatedNextKm = LastServiceKm + IntervalValue
        - time-based: CalculatedNextDate = LastServiceDate + IntervalValue days
      - Maps DTOs to entities and back with proper relationships
    - Controller: Created CarsController with POST, GET (all), GET (by id) endpoints
      - Returns 201 Created with Location header
      - Proper error handling and logging
  - Created DTOs:
    - CreateCarDto with nested CreateCarMaintenanceItemDto array
    - CarDto with nested CarMaintenanceItemDto array for responses
  - Validation rules enforced:
    - Name required â†’ "Name is obligatory field"
    - CurrentKm required â†’ "Mileage is obligatory field"
    - CurrentKm must be >= 0
    - MaintenanceItems array can be empty
    - For each maintenance item: MaintenanceTemplateId, IntervalValue (> 0), IntervalType ("km" or "time") required
    - Only non-archived templates can be assigned
  - Database:
    - Updated AppDbContext with Cars and CarMaintenanceItems DbSets
    - Configured entity relationships (Car â†’ CarMaintenanceItems, CarMaintenanceItem â†’ MaintenanceTemplate)
    - Created and applied migration: AddCarAndCarMaintenanceItemEntities
    - Foreign keys: CarId (CASCADE), MaintenanceTemplateId (RESTRICT)
  - Registered services in Program.cs (ICarRepository, ICarService)
  - Tested successfully in docker-compose environment:
    - âœ… Car created with maintenance items returns 201 with correct calculations
    - âœ… Next service km calculated correctly (km-based: 40000 + 10000 = 50000)
    - âœ… Next service date calculated correctly (time-based: 2025-06-15 + 365 days = 2026-06-15)
    - âœ… Car created with no maintenance items (empty array) works
    - âœ… Location header returned with correct URI
    - âœ… Validation errors return 400 (empty name, negative mileage, non-existent template)
    - âœ… Archived templates rejected with 400 error message
    - âœ… GET /api/cars returns all cars sorted by CreatedAt descending
    - âœ… GET /api/cars/{id} returns specific car with maintenance items
  - All acceptance criteria met
  - Build succeeds without warnings
  - Transaction atomicity verified (car + maintenance items created together or not at all)
- âœ… **09 â€“ PATCH Update Car Current Mileage** (Completed: February 18, 2026)
  - Implemented PATCH /api/cars/{id}/km endpoint to update only the current mileage of a car
  - Returns 204 No Content on success (lightweight inline editing for dashboard)
  - Returns 404 Not Found when car doesn't exist
  - Returns 400 Bad Request for validation errors (missing field, negative value)
  - Returns 500 Internal Server Error for unexpected errors
  - Implemented across 3-layer architecture:
    - Repository: Uses existing generic Repository<T> methods (GetByIdAsync, UpdateAsync)
    - Service: UpdateCarMileageAsync checks existence, updates only currentKm field
    - Controller: HttpPatch endpoint with proper validation and error handling
  - Created UpdateCarMileageDto:
    - Single property: CurrentKm (required, must be >= 0)
    - Data annotations for validation: [Required], [Range(0, int.MaxValue)]
  - Validation rules enforced:
    - CurrentKm is required â†’ "Mileage is obligatory field"
    - CurrentKm must be >= 0 â†’ "Mileage must be greater than or equal to 0"
    - Car with id must exist â†’ 404 Not Found
  - Only updates currentKm field, no other car properties or maintenance items affected
  - Tested successfully in docker-compose environment:
    - âœ… PATCH /api/cars/2002/km with valid data returns 204 No Content
    - âœ… CurrentKm updated correctly (verified with GET /api/cars/2002)
    - âœ… Only currentKm field modified, name and maintenance items unchanged
    - âœ… 404 returned for non-existent car ID (99999)
    - âœ… 400 returned for negative mileage with validation error message
    - âœ… 0 km accepted as valid (edge case >= 0)
  - All acceptance criteria met:
    - âœ… PATCH /api/cars/{id}/km updates current mileage
    - âœ… Returns 204 No Content on success
    - âœ… Returns 404 if car not found
    - âœ… Returns 400 for validation errors
    - âœ… Only currentKm field modified
    - âœ… No business logic in controller
    - âœ… Repository pattern respected (uses generic Repository<T>)
    - âœ… Build succeeds without warnings
  - Architecture compliance:
    - Service layer contains update logic
    - Controller only handles HTTP concerns
    - Uses generic Repository<T> - no entity-specific repository needed
    - Async/await throughout
    - Proper status codes and error handling
    - Follows existing patterns from UpdateTemplateAsync
- âœ… **11 â€“ GET Dashboard Data** (Completed: February 18, 2026)
  - Implemented GET /api/dashboard/{carId} endpoint to retrieve dashboard data with calculated maintenance status
  - Returns 200 OK with DashboardDto containing car details and maintenance items with status calculations
  - Returns 404 Not Found when car doesn't exist
  - Returns 500 Internal Server Error for unexpected errors
  - Implemented across 3-layer architecture:
    - Repository: Uses existing generic Repository<T> (no entity-specific repository needed)
    - Service: GetDashboardDataAsync() retrieves car with maintenance items, loads templates efficiently, calculates status dynamically, maps to DashboardDto
    - Controller: Created DashboardController with HttpGet endpoint, proper error handling and logging
  - Created DTOs:
    - DashboardDto with carId, carName, currentKm, and list of dashboard maintenance items
    - DashboardMaintenanceItemDto with all maintenance item fields plus calculated status, kmUntilDue, daysUntilDue
  - Status calculation logic implemented:
    - **km-based items:** kmUntilDue = calculatedNextKm - currentKm
      - Overdue: kmUntilDue < 0
      - DueSoon: 0 <= kmUntilDue <= 300
      - OK: kmUntilDue > 300
    - **time-based items:** daysUntilDue = (calculatedNextDate - Today).TotalDays
      - Overdue: daysUntilDue < 0
      - DueSoon: 0 <= daysUntilDue <= 30
      - OK: daysUntilDue > 30
  - Filters out maintenance items with archived templates (same logic as GetAllCars and GetCarById)
  - Tested successfully in docker-compose environment:
    - âœ… Dashboard data returned with correct car details
    - âœ… All maintenance items include calculated status fields
    - âœ… Status "OK" calculated correctly:
      - km-based: currentKm=50000, calculatedNextKm=55000 â†’ kmUntilDue=5000, status="OK" âœ“
      - time-based: calculatedNextDate=2026-06-15 (117 days from now) â†’ daysUntilDue=117, status="OK" âœ“
    - âœ… Status "DueSoon" calculated correctly:
      - km-based: currentKm=49800, calculatedNextKm=50000 â†’ kmUntilDue=200, status="DueSoon" âœ“
      - time-based: calculatedNextDate=2026-03-10 (20 days from now) â†’ daysUntilDue=20, status="DueSoon" âœ“
    - âœ… Status "Overdue" calculated correctly:
      - time-based: calculatedNextDate=2025-09-12 (159 days ago) â†’ daysUntilDue=-159, status="Overdue" âœ“
    - âœ… 404 error returned for non-existent car ID
    - âœ… Archived templates filtered out correctly
    - âœ… No N+1 query issues - templates loaded efficiently in batch
  - All acceptance criteria met:
    - âœ… GET /api/dashboard/{carId} returns dashboard data
    - âœ… Returns 200 OK with calculated status
    - âœ… Returns 404 if car not found
    - âœ… Status correctly calculated for km-based items (all 3 states tested)
    - âœ… Status correctly calculated for time-based items (all 3 states tested)
    - âœ… kmUntilDue / daysUntilDue calculated correctly
    - âœ… Archived template items excluded
    - âœ… No business logic in controller
    - âœ… Repository pattern respected
    - âœ… Build succeeds without warnings
  - Architecture compliance:
    - Service layer contains all business logic (status calculation)
    - Controller only handles HTTP concerns
    - Uses generic Repository<T> - no entity-specific repository needed
    - Async/await throughout
    - Proper error handling with specific status codes
    - Logging for debugging and monitoring
- âœ… **10 â€“ POST Track Maintenance Change** (Completed: February 18, 2026)
  - Implemented POST /api/trackchange/{carMaintenanceItemId} endpoint to record maintenance service for a specific car maintenance item
  - Returns 201 Created with TrackChangeDto and Location header
  - Returns 404 Not Found when maintenance item doesn't exist
  - Returns 400 Bad Request for validation errors (missing required fields, archived template, future date)
  - Returns 500 Internal Server Error for unexpected errors
  - Implemented across 3-layer architecture:
    - Repository: Uses generic Repository<T> for TrackChange, CarMaintenanceItem, and MaintenanceTemplate (no entity-specific repository needed)
    - Service: TrackChangeAsync() validates maintenance item and template, creates TrackChange record, updates CarMaintenanceItem, recalculates next service values
    - Controller: Created TrackChangeController with HttpPost endpoint, proper error handling and logging
  - Created TrackChange entity:
    - Properties: Id (PK), CarMaintenanceItemId (FK), Km (nullable), Date (nullable)
    - Foreign key to CarMaintenanceItem with CASCADE delete
    - Table: TrackChanges
  - Created DTOs:
    - CreateTrackChangeDto with optional Km and Date fields
    - TrackChangeDto with all TrackChange data for response
  - Business logic implemented:
    - Validates CarMaintenanceItem exists â†’ throws KeyNotFoundException (404)
    - Validates MaintenanceTemplate is not archived â†’ throws ArgumentException (400) with message "Cannot track changes for archived maintenance templates"
    - For km-based items:
      - Validates Km is provided and >= 0
      - Updates lastServiceKm with provided km
      - Recalculates: calculatedNextKm = lastServiceKm + intervalValue
    - For time-based items:
      - Validates Date is provided and not in future
      - Updates lastServiceDate with provided date
      - Recalculates: calculatedNextDate = lastServiceDate + intervalValue days
    - Transaction handling: TrackChange creation and CarMaintenanceItem update in atomic operation
  - Database:
    - Updated AppDbContext with TrackChanges DbSet
    - Configured TrackChange entity relationships in OnModelCreating
    - Created and applied migration: AddTrackChangeEntity
    - Foreign key: CarMaintenanceItemId (CASCADE delete)
  - Registered ITrackChangeService in Program.cs
  - Tested successfully in docker-compose environment:
    - âœ… Time-based maintenance item: POST with date creates TrackChange and updates maintenance item
      - lastServiceDate updated from "2025-03-10T00:00:00" to "2026-02-16T10:00:00"
      - calculatedNextDate recalculated to "2027-02-16T10:00:00" (365 days after last service)
      - Returns 201 Created with TrackChange data (id: 2, carMaintenanceItemId: 2003, date: "2026-02-16T10:00:00", km: null)
    - âœ… Km-based maintenance item: POST with km creates TrackChange and updates maintenance item
      - lastServiceKm updated from 40000 to 52000
      - calculatedNextKm recalculated to 62000 (52000 + 10000)
      - Returns 201 Created with TrackChange data (id: 3, carMaintenanceItemId: 2002, km: 52000, date: null)
    - âœ… 404 error returned for non-existent maintenance item ID (99999)
    - âœ… 400 error with message "Km is required for km-based maintenance items" when km missing for km-based item
    - âœ… 400 error with message "Date is required for time-based maintenance items" when date missing for time-based item
    - âœ… 400 error with message "Cannot track changes for archived maintenance templates" when template is archived
    - âœ… 400 error with message "Date cannot be in the future" when date is in future
    - âœ… Transaction atomicity verified (both TrackChange and CarMaintenanceItem updated together)
    - âœ… Location header included in 201 response
  - All acceptance criteria met:
    - âœ… POST /api/trackchange/{carMaintenanceItemId} creates TrackChange record
    - âœ… Returns 201 Created with Location header
    - âœ… TrackChange record created in database
    - âœ… CarMaintenanceItem lastServiceKm/Date updated correctly
    - âœ… Next service km/date recalculated correctly based on interval type
    - âœ… Returns 404 if maintenance item not found
    - âœ… Returns 400 for all validation errors (missing required fields, archived template, future date)
    - âœ… Transaction ensures atomicity (create TrackChange + update CarMaintenanceItem)
    - âœ… No business logic in controller
    - âœ… Repository pattern respected (generic Repository<T> used)
    - âœ… Build succeeds without warnings
  - Architecture compliance:
    - Service layer contains all business logic (validation, recalculation)
    - Controller only handles HTTP concerns
    - Uses generic Repository<T> - no entity-specific repository needed
    - Async/await throughout
    - Proper error handling with specific status codes (201, 400, 404, 500)
    - Logging for debugging and monitoring
    - Transaction handling in repository layer (SaveChangesAsync)
    - DTOs for input/output separation

### Frontend
- âœ… **01 â€“ Display Maintenance Templates** (Completed: February 18, 2026)
  - Implemented GET /api/setup endpoint integration to fetch all maintenance templates
  - Created reusable components following feature-based architecture:
    - `EmptyState` component in `src/components/feedback/` for empty state display
    - `TemplateCard` component in `src/features/templates/components/` for individual template display
    - `TemplateList` component in `src/features/templates/components/` for template list rendering
  - Created `useFetchTemplates` custom hook in `src/features/templates/hooks/` for data fetching with loading/error states
  - Created `formatDate` utility in `src/utils/` for date formatting
  - Added `getAllMaintenanceTemplates()` function to templates API service
  - Updated SetupPage to display templates with loading, error, and empty states
  - Templates display all required information:
    - Template name with visual distinction for archived status (gray background + "Archived" badge)
    - Interval type (km/time) and value with appropriate labels
    - Created date formatted as readable string (e.g., "Feb 18, 2026")
    - Edit, Archive, and Restore buttons (placeholders for future tasks)
  - Automatic template list refresh after creating new template
  - Features implemented:
    - Loading spinner centered during fetch
    - Error notification with Alert component on API failure
    - Empty state message when no templates exist
    - Responsive card layout using Tailwind CSS
    - Proper sorting (newest first - handled by backend)
  - All acceptance criteria met
  - No TypeScript errors (strict typing enforced)
  - Successfully tested in dockerized environment (frontend + backend + database)
  - Templates fetch and render correctly with all fields displaying properly
- âœ… **02 â€“ Add Maintenance Template** (Completed: February 18, 2026)
  - Created AddTemplateForm component with modal UI
  - Implemented form validation with specific error messages
  - Added API service layer with fetch-based HTTP client
  - Created type definitions for MaintenanceTemplate and DTOs
  - Added /setup route with placeholder page
  - Form features:
    - Name, Interval Type (km/time), and Interval Value fields
    - Dynamic label showing "km" or "days" based on interval type
    - Real-time field validation and error display
    - Loading state with spinner during submission
    - Success notification on create
    - Server error handling (400, 500)
    - Duplicate submission prevention
  - All acceptance criteria met
  - TypeScript compilation successful (no errors)
  - Tested successfully in dockerized environment (frontend + backend + database)- âœ… **06 â€“ Add Car with Maintenance Items** (Completed: February 18, 2026)
  - Implemented POST /api/cars endpoint integration to create new cars with maintenance items
  - Created comprehensive type definitions and API layer:
    - `src/types/car.ts` with Car, CreateCarDto, and CreateCarMaintenanceItemDto interfaces
    - `src/features/cars/api/cars-api.ts` with createCar and getAllCars functions
    - Updated `src/constants/api-endpoints.ts` with CARS endpoint
  - Created cars feature folder structure following feature-based architecture:
    - **Hooks:**
      - `use-car-form.ts` - Complex form state management with Map-based selectedTemplates tracking
      - `use-create-car.ts` - API submission logic with success/error handling
    - **Components:**
      - `maintenance-item-selector.tsx` - Template selection with checkboxes, displays available non-archived templates
      - `maintenance-item-form.tsx` - Dynamic interval editing and last service inputs (km or date based on type)
  - Created reusable DateInput component (`src/components/ui/date-input.tsx`):
    - Implements dd/mm/yyyy input mask with automatic formatting
    - Removes non-numeric characters automatically
    - Formats as user types (dd â†’ dd/mm â†’ dd/mm/yyyy)
    - Includes validation and error display
  - Created AddCarPage (`src/pages/cars/add-car-page.tsx`):
    - Multi-section form layout (Car Details + Assign Maintenance Items)
    - Fetches non-archived templates on page load using useFetchTemplates hook
    - Template selection with checkboxes - shows template name and interval info
    - Dynamic maintenance item configuration section (only shows when templates selected)
    - Conditional last service inputs:
      - km-based templates: number input for lastServiceKm
      - time-based templates: date input with dd/mm/yyyy mask for lastServiceDate
    - Date format conversion: dd/mm/yyyy â†’ ISO 8601 format for backend
    - Comprehensive validation:
      - Name required â†’ "Name is obligatory field"
      - Mileage required â†’ "Mileage is obligatory field"
      - Mileage must be >= 0
      - Interval values must be > 0 for each selected item
      - Date validation: day <= 31, month <= 12, year >= 2000
    - Loading states with spinner during template fetch and car submission
    - Success notification "Car created successfully" with auto-navigation
    - Server error handling (400, 500) with user-friendly messages
    - Back button and Cancel button both navigate to /cars
    - Disable form inputs and buttons during submission
  - Created CarsListPage placeholder (`src/pages/cars/cars-list-page.tsx`):
    - Simple placeholder for redirect target (full implementation in Task #05)
    - Includes "Add Car" button for navigation to /cars/new
  - Updated router (`src/app/router.tsx`):
    - Added /cars route for CarsListPage
    - Added /cars/new route for AddCarPage
  - Form features:
    - Clean card-based UI with proper spacing and shadows
    - Responsive layout with max-width container
    - Clear section headers and descriptions
    - Dynamic labels showing "km" or "days" based on interval type
    - Collapsible selected items section with count display
    - Proper error message positioning under each field
    - Consistent button styling with loading states
  - Edge cases handled:
    - Creating car with no maintenance items (empty array) works correctly
    - No templates available shows empty state message
    - Archived templates properly excluded from selection
    - Invalid date formats caught by frontend validation
    - Backend validation errors properly displayed
    - Network errors handled gracefully
  - All acceptance criteria met:
    - âœ… Page accessible at /cars/new
    - âœ… Form displays correctly with all fields
    - âœ… Templates fetched and displayed
    - âœ… Archived templates excluded
    - âœ… All validations work with correct error messages
    - âœ… POST request creates car successfully
    - âœ… Navigates to /cars after success
    - âœ… Success notification shown
    - âœ… Cancel navigates back without saving
    - âœ… Date mask works correctly (dd/mm/yyyy)
    - âœ… Dynamic interval labels (km/days)
    - âœ… No console errors
    - âœ… No TypeScript errors
  - Tested successfully in dockerized environment (frontend + backend + database):
    - âœ… Car created with maintenance items returns 201 with correct data
    - âœ… Car created without maintenance items works
    - âœ… Non-archived templates fetched and displayed correctly
    - âœ… Date format conversion works (dd/mm/yyyy â†’ ISO 8601)
    - âœ… Next service calculations correct (verified via API)
    - âœ… Navigation to /cars works after successful creation
    - âœ… Validation errors display correctly
    - âœ… Loading states work properly
  - Architecture compliance:
    - Feature-based structure maintained
    - Separation of concerns (hooks, components, API layer)
    - Reusable components in proper locations
    - Type safety with strict TypeScript
    - Consistent styling with Tailwind CSS
    - No business logic in page components
- âœ… **05 â€“ Display Cars List** (Completed: February 18, 2026)
  - Implemented GET /api/cars endpoint integration on Cars page
  - Created reusable utility function:
    - `formatNumber` in `src/utils/format-number.ts` for mileage formatting with thousand separators (e.g., "52,000 km")
  - Created feature components following feature-based architecture:
    - `CarCard` component in `src/features/cars/components/` displays individual car information:
      - Car name (prominent bold heading)
      - Current mileage (formatted with thousand separators + " km")
      - Number of maintenance items
      - Created date (formatted as readable string)
      - Edit button (navigates to /cars/{id}/edit - placeholder for Task #07)
      - View Details button (placeholder for Task #08)
    - `CarList` component in `src/features/cars/components/` renders responsive grid layout of car cards
  - Created `useFetchCars` custom hook in `src/features/cars/hooks/` for data fetching with loading/error states
  - Updated CarsListPage to display full cars list with:
    - Automatic fetch on page load
    - Loading spinner centered during fetch
    - Error notification with clear message on API failure
    - Empty state message: "No cars available. Add your first car to get started."
    - Responsive grid layout (1 column mobile, 2 columns tablet, 3 columns desktop)
    - "Add Car" button at top (navigates to /cars/new)
  - Cars display all required information:
    - Car name most prominent (text-xl font-bold)
    - Current mileage formatted correctly (e.g., "50,000 km")
    - Maintenance items count
    - Created date formatted as readable string (e.g., "Feb 18, 2026")
  - Features implemented:
    - Loading state displayed during fetch (centered LoadingSpinner)
    - Error notification shown on failure (red alert box)
    - Empty state when no cars exist (EmptyState component)
    - Cars sorted by backend (newest first - CreatedAt descending)
    - Edit and View Details buttons on each card
    - Responsive card layout with proper spacing
    - Visual hierarchy with car name most prominent
  - All acceptance criteria met:
    - âœ… Page loads and fetches cars automatically
    - âœ… Cars render correctly with all required fields
    - âœ… Empty state shown when no cars exist
    - âœ… Add Car button navigates to /cars/new
    - âœ… Edit button navigates to /cars/{id}/edit
    - âœ… Loading state displayed during fetch
    - âœ… Error notification shown on failure
    - âœ… Sorting matches backend (newest first)
    - âœ… Mileage formatted correctly with thousand separators
    - âœ… No console errors
    - âœ… No TypeScript errors
    - âœ… Responsive on mobile and desktop
  - Edge cases handled:
    - Cars with no maintenance items display "0" count
    - Network failures show error message
    - Empty array response shows empty state
    - Backend errors (500) display error notification
  - Tested successfully in dockerized environment (frontend + backend + database):
    - âœ… Multiple cars displayed correctly in grid layout
    - âœ… All car fields render properly (name, mileage, maintenance count, date)
    - âœ… Mileage formatted with thousand separators (e.g., "50,000 km", "365,000 km")
    - âœ… Maintenance items count accurate for cars with/without items
    - âœ… Dates formatted correctly (e.g., "Feb 18, 2026")
    - âœ… Loading spinner shows during fetch
    - âœ… Empty state tested (displays correct message when no cars)
    - âœ… Edit button navigation works (routes to /cars/{id}/edit)
    - âœ… Add Car button works (routes to /cars/new)
    - âœ… Responsive layout verified (grid adjusts for different screen sizes)
    - âœ… Sorting verified (newest cars appear first)
  - Architecture compliance:
    - Feature-based structure maintained (cars feature folder)
    - Separation of concerns (useFetchCars hook, CarList/CarCard components, API layer)
    - Reusable utility functions in proper location (utils folder)
    - Type safety with strict TypeScript (no errors)
    - Consistent styling with Tailwind CSS
    - No business logic in page components (logic in hooks)
    - Follows same patterns as templates feature
- âœ… **09 â€“ Display Dashboard with Car Selector** (Completed: February 18, 2026)
  - Implemented GET /api/dashboard/{carId} endpoint integration with car selector dropdown
  - Created comprehensive dashboard feature following feature-based architecture:
    - **Types & API Layer:**
      - `src/types/dashboard.ts` - Dashboard and DashboardMaintenanceItem type definitions with status calculations
      - `src/features/dashboard/api/dashboard-api.ts` - getDashboardData() API function
      - Updated `src/constants/api-endpoints.ts` with DASHBOARD endpoint
    - **Custom Hooks:**
      - `useFetchDashboard` hook for fetching dashboard data with loading/error states
      - `useCarSelector` hook for managing car selection (auto-selects first car on load)
    - **Feature Components:**
      - `CarSelector` component - Dropdown for car selection using existing Select UI component
      - `DashboardHeader` component - Displays car name and current mileage (formatted with thousand separators)
      - `MaintenanceGroup` component - Status group container with color-coded sections (red/yellow/green)
      - `MaintenanceItemCard` component - Individual maintenance item card with all details
  - Created DashboardPage (`src/pages/dashboard/dashboard-page.tsx`):
    - Fetches all cars for dropdown selector on page load
    - Auto-selects first car by default
    - Fetches dashboard data when car is selected
    - Groups maintenance items by status (Overdue, DueSoon, OK)
    - Displays three color-coded sections with status icons (ðŸ”´, ðŸŸ¡, ðŸŸ¢)
    - Each section shows empty state when no items in that category
    - Loading states during cars fetch and dashboard data fetch
    - Error notifications for both cars and dashboard API failures
    - No cars state with message: "No cars available. Add a car first."
  - Updated router (`src/app/router.tsx`) to add /dashboard route
  - Maintenance item cards display all required information:
    - Template name (bold heading)
    - Interval info (e.g., "Every 10,000 km" or "Every 365 days")
    - Last service (km or date formatted)
    - Next due (km or date formatted)
    - Until due text (e.g., "5,000 km remaining" or "20 days remaining" or "159 days overdue")
    - Track Change button (placeholder for future task)
  - Status grouping logic:
    - **Overdue Section (Red):** Items with status "Overdue" (negative kmUntilDue or daysUntilDue)
    - **Due Soon Section (Yellow):** Items with status "DueSoon" (0-300 km or 0-30 days)
    - **OK Section (Green):** Items with status "OK" (> 300 km or > 30 days)
  - Features implemented:
    - Car selector prominently placed at top with label
    - Car selector disabled during dashboard data fetch
    - Dashboard header shows car name and formatted mileage
    - Color-coded section backgrounds and borders (red-50/300, yellow-50/300, green-50/300)
    - Status icons for visual distinction (ðŸ”´, ðŸŸ¡, ðŸŸ¢)
    - Responsive grid layout for maintenance items (1/2/3 columns)
    - Empty state for each section: "No items in this category"
    - Loading spinner centered during fetch operations
    - Error notifications with clear messages
    - Car selection triggers automatic data refresh
  - All acceptance criteria met:
    - âœ… Dashboard page loads correctly at /dashboard
    - âœ… Car selector displays all cars from backend
    - âœ… Default car selected on load (first car)
    - âœ… Dashboard data fetched for selected car
    - âœ… Maintenance items grouped correctly by status (Overdue, DueSoon, OK)
    - âœ… Each item displays all required information
    - âœ… Color coding works correctly (red/yellow/green)
    - âœ… Empty states shown for empty sections
    - âœ… Loading state displayed during fetch
    - âœ… Error notification shown on failure
    - âœ… No cars state handled correctly
    - âœ… Car selection triggers data refresh
    - âœ… No console errors
    - âœ… No TypeScript errors
    - âœ… Responsive on mobile and desktop
  - Edge cases handled:
    - No cars available shows empty state
    - Cars with no maintenance items show all three empty sections
    - API errors display error notifications
    - Network failures handled gracefully
    - Car selector updates trigger fresh dashboard fetch
    - Different interval types (km/time) display correctly
    - Negative values show as "overdue" instead of "remaining"
  - Tested successfully in dockerized environment (frontend + backend + database):
    - âœ… Dashboard page accessible at http://localhost:3000/dashboard
    - âœ… Car selector populated with 11 cars from database
    - âœ… First car auto-selected on page load
    - âœ… Dashboard data fetched correctly for selected car
    - âœ… All three status groups tested:
      - Overdue: Car 1006 shows Air Filter (-159 days overdue) in red section âœ…
      - DueSoon: Car 2002 shows Oil Change (200 km remaining) in yellow section âœ…
      - OK: Car 1 shows Annual Inspection (117 days remaining) in green section âœ…
    - âœ… Multiple items per car display correctly (Car 1006 has items in Overdue and OK sections)
    - âœ… Maintenance item details all display correctly:
      - Template names shown
      - Interval info formatted (e.g., "Every 10,000 km", "Every 365 days")
      - Last service formatted (km with thousand separators, dates as readable strings)
      - Next due formatted correctly
      - Until due text shows correct values with "remaining" or "overdue"
    - âœ… Empty sections show "No items in this category" message
    - âœ… No cars scenario tested (shows appropriate message)
    - âœ… Car selector dropdown functional and triggers data refresh
    - âœ… Loading spinners display during fetch operations
    - âœ… Color coding verified (red/yellow/green backgrounds and borders)
    - âœ… Status icons display correctly (ðŸ”´, ðŸŸ¡, ðŸŸ¢)
    - âœ… Responsive layout verified (grid adjusts for screen sizes)
    - âœ… TypeScript compilation successful (no errors)
    - âœ… Track Change buttons render on all items (placeholders for future task)
  - Architecture compliance:
    - Feature-based structure maintained (dashboard feature folder)
    - Separation of concerns (hooks for data fetching, components for presentation, API layer)
    - Page component thin - only orchestrates composition
    - Reusable UI components leveraged (Card, Select, Button, Container, LoadingSpinner, EmptyState)
    - Type safety with strict TypeScript (all interfaces properly defined)
    - Consistent styling with Tailwind CSS (color-coded sections, responsive grids)
    - No business logic in page components (status grouping in page, but simple filtering)
    - Follows established patterns from cars and templates features
    - Proper async/await error handling throughout
- âœ… **10 â€“ Update Current Mileage Inline (Dashboard)** (Completed: February 18, 2026)
  - Implemented inline mileage editing on Dashboard page
  - Created comprehensive inline editing feature following feature-based architecture:
    - **Types & API Layer:**
      - Added `UpdateCarMileageDto` interface in `src/types/car.ts`
      - Added `updateCarMileage()` function in `src/features/cars/api/cars-api.ts`
      - Updated `api-client.ts` to handle 204 No Content responses properly
    - **Custom Hooks:**
      - Created `useUpdateMileage` hook in `src/features/dashboard/hooks/` for inline editing state management
      - Manages isEditing, editValue, isLoading, and error states
      - Handles validation (>= 0, integer, required)
      - Provides startEditing, cancelEditing, handleSave, handleKeyDown functions
      - Calls API with proper error handling (400, 404, 500)
    - **Updated Components:**
      - Updated `DashboardHeader` component with inline editing UI
        - Display mode: Shows formatted mileage with blue pencil/edit icon
        - Edit mode: Shows input field with save (green checkmark) and cancel (X) buttons
        - Displays validation errors in red below input
        - Loading spinner during save operation
        - Keyboard shortcuts hint text
      - Updated `DashboardPage` to handle mileage updates:
        - Added success notification "Mileage updated successfully" (auto-dismisses after 3 seconds)
        - Passes carId and onMileageUpdated callback to DashboardHeader
        - Calls refetch() to refresh dashboard data after successful update
  - Inline editing features implemented:
    - Click on mileage or edit icon to enter edit mode
    - Input field pre-filled with current value (autofocus)
    - Save button (green with checkmark icon) updates mileage
    - Cancel button (gray with X icon) reverts to original value
    - Loading state: spinner replaces save icon, buttons disabled during API call
    - Smooth transitions between display and edit modes
    - Clear visual indication of editable field (blue edit icon with hover effect)
  - Validation rules enforced (frontend):
    - Mileage required â†’ "Mileage is obligatory field"
    - Must be valid number â†’ "Mileage must be a valid number"
    - Must be integer â†’ "Mileage must be an integer"
    - Must be >= 0 â†’ "Mileage must be greater than or equal to 0"
    - Error messages display in red below input field
  - Keyboard shortcuts implemented:
    - Esc key cancels editing and reverts changes
    - Enter key validates and saves changes
    - Help text displayed: "Press Enter to save, Esc to cancel"
  - Error handling implemented:
    - 400 Bad Request â†’ displays backend validation message or "Invalid mileage value"
    - 404 Not Found â†’ "Car not found"
    - 500 Server Error â†’ "Failed to update mileage. Please try again."
    - Network errors â†’ "Network error. Please try again."
    - Errors display in red below input field
  - Success flow:
    - API returns 204 No Content
    - Edit mode exits automatically
    - Success notification appears at top of dashboard (green alert)
    - Dashboard data refreshes automatically (status calculations update)
    - Notification auto-dismisses after 3 seconds
  - All acceptance criteria met:
    - âœ… Current mileage is editable inline
    - âœ… Edit mode activates on click
    - âœ… Input field pre-filled with current value
    - âœ… Validation works (km >= 0, integer, required)
    - âœ… PATCH request updates mileage successfully
    - âœ… Dashboard data refreshes after update
    - âœ… Status calculations update (items may move between groups)
    - âœ… Success notification shown
    - âœ… Cancel reverts to original value
    - âœ… Error handling works (400, 404, 500)
    - âœ… Keyboard shortcuts work (Esc, Enter)
    - âœ… No console errors
    - âœ… No TypeScript errors
  - Tested successfully in dockerized environment (frontend + backend + database):
    - **Backend API Testing:**
      - âœ… PATCH /api/cars/{id}/km returns 204 No Content
      - âœ… Mileage updated successfully (50000 â†’ 52000)
      - âœ… Dashboard endpoint reflects updated mileage immediately
      - âœ… Validation: negative values return 400 Bad Request
      - âœ… Error handling: non-existent car (ID 99999) returns 404 Not Found
    - **Frontend UI Testing:**
      - âœ… Display mode shows formatted mileage (e.g., "52,000 km") with edit icon
      - âœ… Hover effect on edit icon works correctly
      - âœ… Clicking edit icon activates inline editing mode
      - âœ… Input field appears with current value pre-filled and autofocused
      - âœ… Save and Cancel buttons clearly visible
      - âœ… Typing in input field updates editValue state
      - âœ… Save button validates input before API call
      - âœ… Loading spinner displays during API call (replaces save icon)
      - âœ… Buttons disabled during save operation
      - âœ… Success notification appears after successful save
      - âœ… Dashboard data refreshes automatically after save
      - âœ… Status calculations recalculated (maintenance items may change groups)
      - âœ… Success notification auto-dismisses after 3 seconds
      - âœ… Cancel button reverts to original value without API call
      - âœ… Returns to display mode after save or cancel
      - âœ… Validation errors display correctly:
        - Empty value â†’ "Mileage is obligatory field"
        - Negative value â†’ "Mileage must be greater than or equal to 0"
        - Non-integer â†’ "Mileage must be an integer"
        - Non-numeric â†’ "Mileage must be a valid number"
      - âœ… Keyboard shortcuts work:
        - Esc key cancels editing
        - Enter key validates and saves
      - âœ… Help text displayed below input
      - âœ… Smooth transitions between display and edit modes
      - âœ… API error handling tested (displays appropriate error messages)
      - âœ… No console errors
      - âœ… TypeScript compilation successful
  - Architecture compliance:
    - Feature-based structure maintained (dashboard hooks, cars API)
    - Separation of concerns (useUpdateMileage hook for logic, DashboardHeader for UI)
    - Page component handles orchestration (notifications, refresh)
    - Reusable UI components leveraged (Alert for notifications)
    - Type safety with strict TypeScript (UpdateCarMileageDto interface)
    - Consistent styling with Tailwind CSS (inline form, buttons, transitions)
    - No business logic in components (all in useUpdateMileage hook)
    - Follows established patterns from other features
    - Proper error handling with user-friendly messages
    - API client updated to handle 204 No Content responses (undefined as T)
    - Loading states and disabled states properly managed- âœ… **08 â€“ Track Change from Cars Page** (Completed: February 18, 2026)
  - Implemented Track Change functionality from Car Detail page with modal UI
  - Created comprehensive car detail page and track change feature following feature-based architecture:
    - **Types & API Layer:**
      - Added `CreateTrackChangeDto` and `TrackChangeDto` interfaces in `src/types/car.ts`
      - Added `TRACK_CHANGE` endpoint constant in `src/constants/api-endpoints.ts`
      - Added `trackChange()` and `getCarById()` functions in `src/features/cars/api/cars-api.ts`
    - **Custom Hooks:**
      - Created `useTrackChange` hook in `src/features/cars/hooks/` for modal state management
      - Manages isOpen, isLoading, error, kmValue, dateValue states
      - Auto-fills current km or today's date based on interval type
      - Handles validation (required fields, >= 0 for km, date format, no future dates)
      - Provides openModal, closeModal, handleSubmit functions
      - Calls API with proper error handling (400, 404, 500)
    - **Feature Components:**
      - Created `TrackChangeModal` component in `src/features/cars/components/`
        - Modal with maintenance item details (template name, interval, last service, next due)
        - Conditional input: km (number) for km-based, date (dd/mm/yyyy mask) for time-based
        - Auto-filled values (car's current km or today's date)
        - User can override auto-filled values
        - Save/Cancel buttons with loading state
        - Validation error display
      - Created `MaintenanceItemCard` component in `src/features/cars/components/`
        - Displays individual maintenance item details
        - Shows template name, interval info, last service, next due
        - Conditional display based on interval type (km vs time)
        - Track Change button
    - **Car Detail Page:**
      - Created `CarDetailPage` (`src/pages/cars/car-detail-page.tsx`)
      - Fetches specific car data using GET /api/cars/{id}
      - Displays car name and current mileage (formatted with thousand separators)
      - Lists all maintenance items in responsive grid (1/2/3 columns)
      - Each item has Track Change button that opens modal
      - Success notification "Maintenance tracked successfully" (auto-dismisses after 3 seconds)
      - Car data auto-refreshes after successful track change
      - Back to Cars button for navigation
      - Loading state during fetch
      - Error handling with user-friendly messages
  - Updated router (`src/app/router.tsx`) to add `/cars/:id` route
  - Updated `CarCard` component to make "View Details" button functional (navigates to `/cars/:id`)
  - Track Change form features:
    - Auto-fill current km or today's date based on interval type
    - User can override auto-filled values
    - Real-time validation with error messages
    - Loading state with disabled buttons during submission
    - Success notification after tracking
    - Modal closes on success or cancel
  - Validation rules enforced (frontend):
    - **km-based items:**
      - Km required â†’ "Km is required for km-based maintenance items"
      - Km must be valid number â†’ "Km must be a valid number"
      - Km must be >= 0 â†’ "Km must be greater than or equal to 0"
    - **time-based items:**
      - Date required â†’ "Date is required for time-based maintenance items"
      - Date format dd/mm/yyyy â†’ "Date must be in dd/mm/yyyy format"
      - Day 1-31, Month 1-12, Year >= 2000
      - Date cannot be in future â†’ "Date cannot be in the future"
  - Date format conversion: dd/mm/yyyy â†’ ISO 8601 format (yyyy-mm-ddT10:00:00) for backend
  - Error handling implemented:
    - 400 Bad Request â†’ displays backend validation message or "Invalid data provided"
    - 404 Not Found â†’ "Maintenance item not found"
    - 500 Server Error â†’ "Failed to track change. Please try again."
    - Network errors â†’ "Network error. Please try again."
  - All acceptance criteria met:
    - âœ… Track Change button visible on each maintenance item
    - âœ… Modal opens correctly with maintenance details
    - âœ… Auto-fill works for km/date based on type
    - âœ… User can override auto-filled values
    - âœ… All validations work (required, >= 0, date format, no future dates)
    - âœ… POST request records change successfully
    - âœ… Car data refreshes after success
    - âœ… Success notification shown
    - âœ… Modal closes after save
    - âœ… Cancel closes modal without changes
    - âœ… No console errors
    - âœ… No TypeScript errors
  - Tested successfully in dockerized environment (frontend + backend + database):
    - âœ… Cars list page accessible at http://localhost:3000/cars
    - âœ… "View Details" button navigates to car detail page (/cars/{id})
    - âœ… Car detail page displays car information correctly (name, mileage)
    - âœ… Maintenance items displayed in responsive grid layout
    - âœ… Track Change button on each item
    - âœ… Modal opens with correct maintenance item details
    - âœ… Auto-fill tested:
      - km-based: auto-fills with car's current km
      - time-based: auto-fills with today's date (dd/mm/yyyy format)
    - âœ… User can edit auto-filled values
    - âœ… Date input mask works correctly (dd/mm/yyyy)
    - âœ… Save button triggers API call
    - âœ… Success flow tested:
      - POST /api/trackchange/{id} creates TrackChange record
      - Success notification appears
      - Car data refreshes automatically
      - Modal closes
      - Maintenance item shows updated last service and next due values
    - âœ… Cancel button closes modal without API call
    - âœ… Validation errors tested:
      - Empty km for km-based â†’ error message displayed
      - Empty date for time-based â†’ error message displayed
      - Negative km â†’ error message displayed
      - Invalid date format â†’ error message displayed
      - Future date â†’ error message displayed
    - âœ… Backend error handling tested:
      - 404 for non-existent maintenance item â†’ error message displayed
      - 400 for validation errors â†’ error message displayed
    - âœ… Loading state works (Save button disabled during submission)
    - âœ… Empty state when car has no maintenance items
    - âœ… Back button navigates to cars list
    - âœ… TypeScript compilation successful (no errors)
    - âœ… No console errors during testing
  - Architecture compliance:
    - Feature-based structure maintained (cars feature folder)
    - Separation of concerns (useTrackChange hook for logic, components for UI, API layer)
    - Page component thin - only orchestrates composition
    - Reusable UI components leveraged (Modal, Input, DateInput, Button, Card, Alert)
    - Type safety with strict TypeScript (CreateTrackChangeDto, TrackChangeDto interfaces)
    - Consistent styling with Tailwind CSS (modal, cards, responsive grids)
    - No business logic in page components (all in useTrackChange hook)
    - Follows established patterns from other features (templates, dashboard)
    - Proper async/await error handling throughout
    - Router updated to support dynamic car detail route (/cars/:id)
    - CarCard navigation implemented correctly